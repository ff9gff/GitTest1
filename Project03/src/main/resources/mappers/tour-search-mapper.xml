<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="edu.spring.project03.TourSearchMapper">

	<!-- 디폴트로 뿌려주는 게시글 -->
	<select id="select_default_image" resultType="edu.spring.project03.domain.ImgVO">
		select * from wm_image 
		where board_type = 1 order by content_no desc
	</select>
	
	<select id="select_default_title" resultType="edu.spring.project03.domain.TourRegisterVO">
		select * from wm_tour order by trip_no desc
	</select>
	
	<select id="select_default_region" resultType="edu.spring.project03.domain.RegionVO">
		select * from wm_tour_region order by trip_no desc
	</select>
	
	<!-- 지역 검색 -->
	<select id="select_main_image_region" resultType="edu.spring.project03.domain.ImgVO">
		select * from wm_image
		where board_type = 1 and content_no in (select trip_no from wm_tour_region
												where region_name like #{region_name})
		order by content_no desc
	</select>

	<select id="select_main_title_region" resultType="edu.spring.project03.domain.TourRegisterVO">
		select * from wm_tour 
        where trip_no in (select trip_no from wm_tour_region
						  where region_name like #{region_name})
		order by trip_no desc
	</select>
 
 	<select id="select_main_region_region" resultType="edu.spring.project03.domain.RegionVO">
 		select * from wm_tour_region
 		where trip_no in (select trip_no from wm_tour_region
						  where region_name like #{region_name})
		order by trip_no desc
 	</select>
	
	

	<!-- 기간 검색 -->
	<select id="select_main_trip_image" resultType="edu.spring.project03.domain.ImgVO">
		select * from wm_image
		where board_type = 1 and content_no in (select trip_no from wm_tour 
                            					where start_date <![CDATA[<]]> to_date(#{end_date},'YYYY-MM-DD')+1
                            					and end_date <![CDATA[>=]]> to_date(#{start_date},'YYYY-MM-DD'))
	</select>

	<select id="select_main_trip_title" resultType="edu.spring.project03.domain.TourRegisterVO">
		select * from wm_tour 
        where start_date <![CDATA[<]]> to_date(#{end_date},'YYYY-MM-DD')+1
        and end_date <![CDATA[>=]]> to_date(#{start_date},'YYYY-MM-DD')
	</select>
 
 	<select id="select_main_trip_region" resultType="edu.spring.project03.domain.RegionVO">
 		select * from wm_tour_region
 		where trip_no in (select trip_no from wm_tour 
                            where start_date <![CDATA[<]]> to_date(#{end_date},'YYYY-MM-DD')+1
                            and end_date <![CDATA[>=]]> to_date(#{start_date},'YYYY-MM-DD'))
 	</select>

	<!-- 상세 검색 1. 성별/나이 검색  -->
	<select id="select-detail-thumnail">
		select * from wm_image
		where content_no in (select trip_no from wm_tour
							 where condition_sex = #{condition_sex} or condition_age = #{condition_age}) and board_type = 1
	</select>
	
	<select id="select-detail-stitle">
		select * from wm_tour
		where trip_no in (select trip_no from wm_tour
							 where condition_sex = #{condition_sex} or condition_age = #{condition_age})
	</select>
	
	<select id="select-detail-sregion">
		select * from wm_tour_region
		where trip_no in (select trip_no from wm_tour
					      where condition_sex = #{condition_sex} or condition_age = #{condition_age})
	</select>
	
	






	
	<select id="select_trip_region" resultType="edu.spring.project03.domain.ImgVO">
		select * from wm_image
		where content_no in (select trip_no from wm_tour_region
		where region_name = #{region_name}) and board_type = 1

	</select>
	
	<select id="select_trip_by_no" resultType="edu.spring.project03.domain.TourRegisterVO">
		select * from wm_tour
		where trip_no = #{trip_no}
	</select>

	<select id="select_trip_person" resultType="edu.spring.project03.domain.PersonalVO">
		select * from wm_personal
		where mno = #{mno}
	</select>
	
	<select id="select_trip_profile" resultType="edu.spring.project03.domain.ImgVO">
		select * from wm_image
		where board_type=3 and content_no = #{mno}
	</select>
	
	<select id="select_trip_region_name" resultType = "String">
		select region_name from wm_tour_region
		where trip_no = #{trip_no}
	</select>
	
	<select id="select_register_data" resultType="edu.spring.project03.domain.TourRegisterVO">
		select * from wm_tour
		where trip_no = #{trip_no}
	</select>

	

</mapper>